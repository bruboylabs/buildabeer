my_list = {
"WLP630" => [77,93],
"OYL-201,WLP645" => [78,79,80,104,105,82,103,87,83,85,84,90,91,92,89,86,88],
"WLP648" => [78,80,104,105,81,82,103,83,85,84,90,91,92,89,86,88],
"5112,OYL-202,WLP650" => [81,87,83,85,84,90,91,92,89,86,88],
"OYL-203,WLP653" => [81,86,88],
"WLP655" => [77,93,78,79],
"WLP661" => [78,79],
"WLP670" => [87,83,85,84,90,91,92,89,86,88],
"WLP672" => [77,93],
"WLP677" => [78,79],
"OYL-217" => [87,83,85,84,90,91,92,89],
"OYL-210" => [82,103],
"OYL-211" => [82,103],
"OYL-212" => [82,103],
"OYL-218" => [82,103],
"OYL-605" => [77,93,78,79],
"3068,G01,GY017,OYL-021,WLP300" => [31,32,33,101,102,96],
"1010,GY020,WLP320" => [4],
"3638,Munich,OYL-025,WLP351" => [31,32,33,101,102,96],
"3333,M20,OYL-022,WLP380" => [31,32,33,101,102,96],
"3944,T-58,WB-06,B44,M21,OYL-030,WLP400" => [83,89,85,84],
"WLP410" => [83,91],
"1214,B63,GY014,OYL-018,WLP500" => [90,91,86,92,88],
"OYL-046,WLP510" => [89,85,84,90,91,86,92,88],
"3787,B48,M47,OYL-028,WLP530" => [90,91,110,109],
"1762,OYL-020,WLP540" => [89,85,84,90,91,86,92,88],
"WLP545" => [90,110,109,86,92,88,111],
"3522,B45,OYL-024,WLP550" => [89,85,84,91],
"GY027,belle saison,OYL-027,WLP565" => [90,91,86,92,88,87],
"3724,WLP566" => [86,92,88,87],
"WLP568" => [91,87],
"1388,GY048,OYL-019,WLP570" => [89,85,84,90,111],
"WLP575" => [89,85,84,90,91,87],
"3711,Belle Saison,B64, GY018,M29,OYL-026,WLP590" => [87],
"A20,OYL-200,WLP644" => [110,109,87],
"3942,OYL-029" => [83,91],
"OYL-049,WLP515" => [89,85,84,90,91],
"3726,B56,OYL-042" => [90,91,86,92,88,87],
"3725,OYL-039" => [89,85,84],
"3822,OYL-040" => [86,92,88],
"1581,B51" => [89,85,84,86,92,88,87],
"2001,WLP800" => [8,9,8,9,18,15],
"2000,2278,WLP802" => [8,9],
"2112,L05,WLP810" => [2,5,99,60,6,7,27],
"2206,WLP820" => [8,9,12,14,17,25,24,13,19,11,10,28,29,14,21,26,20],
"2142,L13,WLP830" => [18,15,8,9,22,6],
"2633,WLP833" => [12,14,17,25,24,99,60,22,13,19,11,10,28,29,14,21,26,20],
"2308,WLP838" => [18,15,12,14,17,25,24,22,13,19,11,10,28,29,14,21,26,20],
"2007,2035,W-34/70,M84,WLP840" => [1,2,5,99,60,22,6,7],
"2042,WLP850" => [18,15,8,9,18,15,2,5,99,60,22,13,19,11,10],
"WLP862" => [11,10],
"WLP920" => [18,15,8,9,8,9,18,15,13,19],
"WLP925" => [8,9,18,15,1,2,5,99,60,6],
"WLP940" => [5,99,60,22,6,7],
"2352,L17,WLP686" => [12,14,17,25,24,13,19,28,29,14,21,26,20],
"1056,S-05,A07,GY001,BRY-97,M44,OYL-004,WLP001" => [3,57,4,76,109,110,111,107,116,117,118,119,120,94,117,114,115,98,37,58,65,67,68,69,70,71,72,59,61,53,74,56,75,54,73],
"1968,A09,London ESB,OYL-016,WLP002" => [39,66,34,35,36,97,41,40,62,30,42,100,53,63,49,51,53,74,56,75,54],
"1084,A10, GY080,OYL-005,WLP004" => [39,66,34,35,36,46,62,30,47,49,51,50,53,74],
"1187,s33,OYL-008,WLP005" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,47,49,51,50,53,74],
"1098,A01,GY031,M07,OYL-006,WLP007" => [116,117,118,119,120,94,39,66,59,34,35,36,43,44,45,46,97,41,40,61,62,30,53,63,53,74,56,75,54,55,48,64,73],
"OYL-032,WLP008" => [4,76,109,110,111,107,37,58,65,67,68,69,70,71,72,59],
"1028,OYL-003,WLP013" => [39,66,34,35,36,97,41,40,62,30,42,100,50,73],
"1728,A31,GY044,OYL-015,WLP028" => [34,35,36,43,44,45,46,61,55],
"G03, GY021,OYL-044,WLP029" => [3,57,117,16,58,65,67,68,69,70,71,72,61,23,55],
"1007,K-97,G02,OYL-001,WLP036" => [3,57,106,107,108,117,16,58,65,67,68,69,70,71,72,61,23,55],
"OYL-012,WLP041" => [58,65,67,68,69,70,71,72,34,35,36,43,44,45,46,97,41,40,61,62,30,42,100,47,53,74,56,75,54],
"1272,A15,OYL-009,WLP051" => [4,76,109,110,111,107,117,37,58,65,67,68,69,70,71,72,59,61,53,63,53,74],
"WLP060" => [3,57,116,117,118,119,120,94,117,16,58,65,67,68,69,70,71,72,59,97,41,40,61,23,73],
"WLP066" => [4,76,117,37,39,66,58,73],
"WLP080" => [3,57,37,16],
"OYL-043,WLP090" => [3,57,4,76,109,110,111,107,116,117,118,119,120,94,117,114,115,98,37,58,65,67,68,69,70,71,72,59,61,53,74,56,75,54,73],
"A04,GY054,WLP095" => [39,66,58,65,67,68,69,70,71,72],
"WLP099" => [53,74,56,75,54],
"1099,S-04,OYL-007,WLP017" => [3,57,116,117,118,119,120,94,39,66,34,35,36,49,51,50],
"1275,windsor,M36,OYL-010,WLP023" => [34,35,36,23,62,30,42,100,47,53,63,48,64],
"1332" => [3,57,4,76,106,107,108,109,110,111,107,58,65,67,68,69,70,71,72,59,61,53,63,49,51,53,74,56,75,54,73],
"1450,OYL-041" => [3,57,109,110,111,107,114,115,98,58,65,67,68,69,70,71,72,59,46,61,42,100,47,53,63,56,75,54,73],
"1469,S-04,OYL-014" => [116,117,118,119,120,94,39,66,34,35,36,49,51,50],
"2565,OYL-017,WLP003" => [3,57,4,76,106,107,108,109,110,111,107,16,23],
"1010,OYL-002" => [3,57,4,76,16,23],
"1217,OYL-050" => [3,57,4,76,109,110,111,107,116,117,118,119,120,94,117,114,115,98,37,58,65,67,68,69,70,71,72,59,61,53,74,56,75,54,73],
"1318,OYL-011" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,53,63,49,51,53,74,56,75,54],
"1335,OYL-013,WLP025" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,53,63,49,51,53,74,56,75,54],
"OYL-047,WLP037" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,53,63,49,51,53,74,56,75,54],
"nottingham,OYL-048,WLP039" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,53,63,49,51,53,74,56,75,54],
"1768,OYL-051" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,53,63,49,51,53,74,56,75,54],
"1026,cbc-1,OYL-038" => [39,66,34,35,36,43,44,45,46,97,41,40,62,30,53,63,49,51,53,74,56,75,54]
}

# current_connections = StyleYeast.all
# current_connections.each do |conn|
#   conn.destroy!
# end

# not_found = []

# my_list.each do |keys, values|
#   keys.split(',').each do |key|
#     my_yeast_id = Yeast.where("product_id = ?", key.strip).first
#     if(!my_yeast_id)
#       not_found << key
#     else
#       my_yeast_id = my_yeast_id.id
#       values.each do |value|
#         a=StyleYeast.new(yeast_id: my_yeast_id, style_id: value)
#         a.save!
#       end
#     end
#   end
# end

# not_found.unique.each do |yeast|
#   puts "Yeast not found: " + yeast
# end


current_connection = YeastRelations.all
current_connections.each do |conn|
  conn.destroy!
end

my_list.each do |keys, values|
  keys.split(',').each_with_index do |first_key, first_index|
    yeast_1 = Yeast.where("product_id = ?", first_key.strip).first
    puts first_index

    if(yeast_1)
      keys.split(',').each_with_index do |second_key, second_index|
      if(first_index < second_index)
        yeast_2 = Yeast.where("product_id = ?", second_key.strip).first

          if(yeast_2)
            my_yeast_id_1 = yeast_1.id
            my_yeast_id_2 = yeast_2.id
            a=YeastRelation.new(yeast_id: my_yeast_id_1, yeast_relation_id: my_yeast_id_2)
            a.save!
          end
        end
      end
    end
  end
end
